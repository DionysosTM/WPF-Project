<Window x:Class="projet_wpf.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:projet_wpf.Views" xmlns:viewmodels="clr-namespace:projet_wpf.ViewModels" d:DataContext="{d:DesignInstance Type=viewmodels:MainViewModel}"
        xmlns:helpers="clr-namespace:projet_wpf.Helpers"
        mc:Ignorable="d"
        Title="MainWindow" Height="450" Width="800">

    <Window.Resources>
        <helpers:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Window.Resources>


    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="5*" />
            <ColumnDefinition Width="1*" />
        </Grid.ColumnDefinitions>

        <DockPanel Grid.Column="0">
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="10">
                <TextBlock Text="Rechercher par tag :" FontSize="10" FontWeight="Bold" Foreground="CornflowerBlue" VerticalAlignment="Center"/>
                <TextBox Margin="5"
                         VerticalAlignment="Center"
                         Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" Width="300"/>
            </StackPanel>
            <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="5">
                <Button Content="📃" ToolTip="Importer fichier(s)" Command="{Binding ImportFilesCommand}" Margin="0,20,10,10" Height="20"/>
                <Button Content="📁" ToolTip="Importer un dossier"  Command="{Binding ImportFolderCommand}" Height="20" Margin="0,20,10,10"/>
                <StackPanel Orientation="Vertical" Margin="0,0,10,10">
                    <TextBlock Text="Type de fichier" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                    <ComboBox ItemsSource="{Binding FileTypes}"
                          SelectedItem="{Binding SelectedFileType, Mode=TwoWay}"
                          Width="100" Margin="0,5,0,0"/>
                </StackPanel>
                <StackPanel Orientation="Vertical" Margin="0,0,10,10">
                    <TextBlock Text="Catégorie de couleur" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                    <ComboBox ItemsSource="{Binding ColorCategories}"
                          SelectedItem="{Binding SelectedColorCategory, Mode=TwoWay}"
                          Width="100" Margin="0,5,0,0">
                    </ComboBox>
                </StackPanel>
                <Button Content="📽️" ToolTip="Diaporama" Command="{Binding StartSlideShowCommand}" Margin="0,20,10,10" Height="20" />
                
            </StackPanel>


            <ScrollViewer>
                <ItemsControl ItemsSource="{Binding VisiblePhotos}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel IsItemsHost="True" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Margin="5" BorderThickness="1" BorderBrush="Gray" Padding="5" CornerRadius="6">
                                <StackPanel HorizontalAlignment="Center">
                                    <Grid>
                                        <Image Source="{Binding Thumbnail}"
                                           Width="150" Height="150"
                                           Stretch="UniformToFill"
                                           MouseLeftButtonDown="OnPhotoMouseLeftButtonDown"/>

                                        <Button Content="⟳"
                                            Width="25" Height="25"
                                            HorizontalAlignment="Right"
                                            VerticalAlignment="Top"
                                            Margin="2"
                                            Command="{Binding DataContext.RotateImageCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                            CommandParameter="{Binding}"/>

                                        <Button Content="🏷️"
                                            Width="25" Height="25"
                                            HorizontalAlignment="Left"
                                            VerticalAlignment="Top"
                                            Margin="2"
                                            Command="{Binding DataContext.AddTagCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                            CommandParameter="{Binding}"/>
                                    </Grid>

                                    <TextBlock Text="{Binding FileName}"
                                       FontWeight="Bold"
                                       FontSize="13"
                                       Foreground="Black"
                                       TextAlignment="Center"
                                       Margin="0,6,0,0"
                                       TextWrapping="Wrap"
                                       MaxWidth="150"/>

                                    <ItemsControl ItemsSource="{Binding Tags}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <WrapPanel HorizontalAlignment="Center"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>

                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="LightGray" CornerRadius="4" Margin="2" Padding="3">
                                                    <Button Content="{Binding Text}"
                                                            FontSize="11"
                                                            Foreground="DarkSlateGray"
                                                            Background="Transparent"
                                                            BorderThickness="0"
                                                            Command="{Binding DataContext.EditTagsCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                            CommandParameter="{Binding}">
                                                    </Button>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </DockPanel>
       
        <WrapPanel Grid.Column="1" Background="CornflowerBlue" Orientation="Vertical">
            <TextBlock Text="Trier" Foreground="White" FontSize="16" Margin="10" HorizontalAlignment="Stretch"/>
            <RadioButton Content="Par nom" Margin="10" GroupName="sort" Checked="Sort"/>
            <RadioButton Content="Par date" Margin="10" GroupName="sort" Checked="Sort"/>
            <RadioButton Content="Par taille" Margin="10" GroupName="sort" Checked="Sort"/>
            <RadioButton Content="Par type" Margin="10" GroupName="sort" Checked="Sort"/>
            <ToggleButton x:Name="SortToggle"
              Margin="10"
              Width="120"
              FontWeight="Bold"
              Checked="callToggleOrder"
              Unchecked="callToggleOrder"
              IsChecked="True"
              HorizontalAlignment="Stretch">
                <ToggleButton.Style>
                    <Style TargetType="ToggleButton">
                        <Style.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter Property="Background" Value="LightGreen"/>
                                <Setter Property="Foreground" Value="DarkGreen"/>
                                <Setter Property="Content" Value="⭡ Croissant"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="False">
                                <Setter Property="Background" Value="LightSalmon"/>
                                <Setter Property="Foreground" Value="DarkRed"/>
                                <Setter Property="Content" Value="⭣ Décroissant"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </ToggleButton.Style>
            </ToggleButton>
        </WrapPanel>
    </Grid>
</Window>
